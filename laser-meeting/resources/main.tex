\documentclass[sigplan,10pt,review=false,nonacm=true]{acmart}
\usepackage{std}

\begin{document}

\title{Resources}
\author{Emily Herbert}

\maketitle

\begin{figure}
\lstset{language=JavaScript}
\begin{lstlisting}
    function login(req) {
        function F(resp) {
            let u = req.body.username;
            let p = req.body.username;
            if(resp[u] === p) {
                respond('ok');
            } else {
                respond('error');
            }
        }
        get('passwords.json', F);
    }
\end{lstlisting}
\caption{Login}
\end{figure}

\begin{figure}
\lstset{language=JavaScript}
\begin{lstlisting}
    let c = require('containerless');

    function main(req) {
        function F(resp) {
            let u = req.body.username;
            let p = req.body.password;
            if (resp[u] === p) {
                c.respond('ok');
            } else {
                c.respond('error');
            }
        }
        c.get('passwords.json', F);
    }
\end{lstlisting}
\caption{Login}
\end{figure}

\begin{figure*}
\lstset{language=JavaScript}
\begin{lstlisting}
    let c = require('containerless');

    function main(req) {
        function F(resp) {
            let u = req.body.username;
            let p = req.body.password;
            if (resp[u] === p) {
                c.respond('ok');
            } else {
                c.respond('error');
            }
        }
        c.get('passwords.json', F);
    }

    c.listen(main);
\end{lstlisting}
\label{login-example-instrumented}
\end{figure*}

\begin{figure*}
\lstset{language=JavaScript}
\begin{lstlisting}[
  linebackgroundcolor={%
  \ifnum\value{lstnumber}=2\color{gray!30}\fi
  \ifnum\value{lstnumber}=5\color{gray!30}\fi
  \ifnum\value{lstnumber}=7\color{gray!30}\fi
  \ifnum\value{lstnumber}=8\color{gray!30}\fi
  \ifnum\value{lstnumber}=9\color{gray!30}\fi
  \ifnum\value{lstnumber}=11\color{gray!30}\fi
  \ifnum\value{lstnumber}=13\color{gray!30}\fi
  \ifnum\value{lstnumber}=14\color{gray!30}\fi
  \ifnum\value{lstnumber}=16\color{gray!30}\fi
  \ifnum\value{lstnumber}=17\color{gray!30}\fi
  \ifnum\value{lstnumber}=19\color{gray!30}\fi
  \ifnum\value{lstnumber}=21\color{gray!30}\fi
  \ifnum\value{lstnumber}=22\color{gray!30}\fi
  \ifnum\value{lstnumber}=24\color{gray!30}\fi
  \ifnum\value{lstnumber}=26\color{gray!30}\fi
  \ifnum\value{lstnumber}=27\color{gray!30}\fi
  \ifnum\value{lstnumber}=29\color{gray!30}\fi
  \ifnum\value{lstnumber}=30\color{gray!30}\fi
  \ifnum\value{lstnumber}=32\color{gray!30}\fi
  }]
    let c = require('containerless');
    let t = require('containerless/tracing');

    function main(req) {
        let [_req] = t.popArgs();
        function F(resp) {
            let [_resp] = t.popArgs();
            let _clos = t.popClosure();
            t.let('req', t.getClos(_clos, 'req'));
            let u = req.body.username;
            t.let('u', t.get(t.get(t.id('req'), 'body'), 'username'));
            let p = req.body.password;
            t.let('p', t.get(t.get(t.id('req'), 'body'), 'password'));
            t.if(t.eq(t.vget(_resp, t.id('u')), t.id('p')));
            if (resp[u] === p) {
                t.ifTrue();
                t.pushArgs(t.str('ok'));
                c.respond('ok');
                t.popResult();
            } else {
                t.ifFalse();
                t.pushArgs(t.str('error'));
                c.respond('error');
                t.popResult();
            }
            t.exitIf();
            t.exitFunction(t.undefined);
        }
        t.let('F', t.closure({ 'req': _req }));
        t.pushArgs([t.str('passwords.json'), t.id('F')]);
        c.get('passwords.json', F);
        t.popResult();
    }

    c.listen(main);
\end{lstlisting}

\label{login-example-instrumented}

\end{figure*}

\begin{figure*}
\begin{subfigure}{\columnwidth}
\small
\[
    \tKw{if}~\tOp{(}\tId{resp}\tOp{[}\tId{u}\tOp{]}~\tOp{===}~\tId{p}\tOp{)}~\tOp{\{}  
    \tId{respond}\tOp{(}\tId{'ok'}\tOp{)}\tOp{;}~\tOp{\}}~\tKw{else}~\tOp{\{}
    \tUnk~\tOp{\}}
\]
\caption{The IR program produced when the username and password combination
is correct.}

\label{ir-correct-password}

\end{subfigure}

\begin{subfigure}{\columnwidth}
\small
\[
\tKw{if}~\tOp{(}\tId{resp}\tOp{[}\tId{u}\tOp{]}~\tOp{===}~\tId{p}\tOp{)}~
\tOp{\{}\tUnk~\tOp{\}}~\tKw{else}~
\tOp{\{}~\tId{respond}\tOp{(}\tId{'error'}\tOp{)}\tOp{;}~\tOp{\}}
\]
\caption{The IR program produced when the username and password combination
is incorrect.}

\label{ir-incorrect-password}

\end{subfigure}
\end{figure*}
    
\begin{figure*}
\lstset{language=JavaScript}
\begin{lstlisting}[escapechar=!]
    if(resp[u] === p) {
        respond('ok');
    } else {
        !\tUnk!
    }
\end{lstlisting}
\end{figure*}

\begin{figure*}
\lstset{language=JavaScript}
\begin{lstlisting}[escapechar=!]
    if(resp[u] === p) {
        respond('ok');
    } else {
        respond('error');
    }
\end{lstlisting}
\end{figure*}

\begin{figure*}
\lstset{language=JavaScript}
\begin{lstlisting}[escapechar=!]
    let u = req.body.username;
    let p = req.body.password;
\end{lstlisting}
\end{figure*}

\begin{figure*}
\lstset{language=JavaScript}
\begin{lstlisting}[escapechar=!]
  event('listen', [], closure(), callback (clos, req) {
    event('get', ['passwords.json'], closure(&req),
      callback(clos, resp) {
        let req = *(clos.req);
        // body
    });
  });
\end{lstlisting}
\end{figure*}

\begin{figure*}
\lstset{language=JavaScript}
\begin{lstlisting}[escapechar=!]
  event('listen', [], closure(), callback (clos, req) {
    event('get', ['passwords.json'],
      closure(&req), callback(clos, resp) {
        let req = *(clos.req);
        let u = req.body.username;
        let p = req.body.password;
        if (resp[u] === p) {
          respond('ok');
        } else {
          respond('error');
        }
      });
  });
\end{lstlisting}
\end{figure*}

\bibliographystyle{ACM-Reference-Format}
\bibliography{references}

\end{document}